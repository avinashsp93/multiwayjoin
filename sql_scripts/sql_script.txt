# R1 -> R2
# region -> nation

SELECT @n:=0;
DROP TABLE ALIGNED_NATION;
CREATE TABLE ALIGNED_NATION
SELECT REGION.R1_SID, NATION.*
from REGION
RIGHT JOIN NATION ON REGION.R_REGIONKEY = NATION.N_REGIONKEY
ORDER BY REGION.R1_SID;
UPDATE ALIGNED_NATION
SET R2_SID = @n := @n + 1;
ALTER TABLE ALIGNED_NATION ADD PRIMARY KEY(N_NATIONKEY);
ALTER TABLE ALIGNED_NATION ADD KEY(REGION.R1_SID);
ALTER TABLE ALIGNED_NATION ADD UNIQUE KEY(NATION.SELF_ID);


# R2->R4
# nation->supplier
SELECT @n:=0;
DROP TABLE supplierA;
CREATE TABLE supplierA
SELECT nationA.R_TWO_SID, supplier.*
from nationA
RIGHT JOIN supplier ON nationA.N_NATIONKEY = supplier.S_NATIONKEY
ORDER BY nationA.R_TWO_SID;
UPDATE supplierA
SET R_FOUR_SID = @n := @n + 1;
ALTER TABLE supplierA ADD PRIMARY KEY(S_SUPPKEY);
ALTER TABLE supplierA ADD KEY(R_TWO_SID);
ALTER TABLE supplierA ADD UNIQUE KEY(R_FOUR_SID);