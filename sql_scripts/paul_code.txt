# R1->R2
# region->nation
# Find R2's new order based on above and put it into a new aligned table

SELECT @n:=0;

DROP TABLE ALIGNED_NATION;

CREATE TABLE ALIGNED_NATION
SELECT ALIGNED_REGION.R1_SID, NATION.*
from ALIGNED_REGION
RIGHT JOIN NATION ON ALIGNED_REGION.R_REGIONKEY = NATION.N_REGIONKEY
ORDER BY ALIGNED_REGION.R1_SID;

ALTER TABLE ALIGNED_NATION ADD R2_SID INTEGER;

UPDATE ALIGNED_NATION
SET R2_SID = @n := @n + 1;

ALTER TABLE ALIGNED_NATION ADD PRIMARY KEY(N_NATIONKEY);
ALTER TABLE ALIGNED_NATION ADD KEY(R1_SID);
ALTER TABLE ALIGNED_NATION ADD UNIQUE KEY(R2_SID);


# R2->R4
# nation->supplier
SELECT @n:=0;
DROP TABLE supplierA;
CREATE TABLE supplierA
SELECT nationA.R_TWO_SID, supplier.*
from nationA
RIGHT JOIN supplier ON nationA.N_NATIONKEY = supplier.S_NATIONKEY
ORDER BY nationA.R_TWO_SID;
UPDATE supplierA
SET R_FOUR_SID = @n := @n + 1;
ALTER TABLE supplierA ADD PRIMARY KEY(S_SUPPKEY);
ALTER TABLE supplierA ADD KEY(R_TWO_SID);
ALTER TABLE supplierA ADD UNIQUE KEY(R_FOUR_SID);


SELECT @n:=0;

DROP TABLE ALIGNED_NATION;
CREATE TABLE ALIGNED_NATION
SELECT ALIGNED_REGION.R1_SID, NATION.*
from ALIGNED_REGION
RIGHT JOIN NATION ON ALIGNED_REGION.R_REGIONKEY = NATION.N_REGIONKEY
ORDER BY ALIGNED_REGION.R1_SID;

ALTER TABLE ALIGNED_NATION ADD R2_SID INTEGER;

UPDATE ALIGNED_NATION
SET R2_SID = @n := @n + 1;

ALTER TABLE ALIGNED_NATION ADD PRIMARY KEY(N_NATIONKEY);

ALTER TABLE ALIGNED_NATION ADD KEY(R1_SID);

ALTER TABLE ALIGNED_NATION ADD UNIQUE KEY(R2_SID);